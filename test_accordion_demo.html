<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×‘×“×™×§×ª ××§×•×¨×“×™×•×Ÿ ×“×™×•×•×— ×ª×§×œ×”</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        /* ×¢×™×¦×•×‘ ×œ××§×•×¨×“×™×•×Ÿ */
        .category-header {
            background-color: #007bff;
            color: white;
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            width: 100%;
            text-align: right;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s;
        }

        .category-header:hover {
            background-color: #0056b3;
        }

        .category-header.active {
            background-color: #28a745;
            border-radius: 8px 8px 0 0;
        }

        .category-content {
            display: none;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 8px 8px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .category-content.active {
            display: block;
        }

        .subcategory-item {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
        }

        .subcategory-item:last-child {
            border-bottom: none;
        }

        .subcategory-item input[type="checkbox"] {
            margin-left: 10px;
            transform: scale(1.2);
        }

        .subcategory-item label {
            cursor: pointer;
            font-size: 14px;
            color: #333;
            flex-grow: 1;
        }
        
        /* ×˜×•×¤×¡ ×’×™×‘×•×™ ××•×¡×ª×¨ */
        #fallbackCategories {
            display: none;
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ffeaa7;
        }
        
        .demo-info {
            background-color: #d4edda;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #c3e6cb;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="demo-info">
            <h3>ğŸ§ª ×“××• - ××§×•×¨×“×™×•×Ÿ ×“×™×•×•×— ×ª×§×œ×”</h3>
            <p>×–×•×”×™ ×‘×“×™×§×” ×©×œ ×”×§×•×“ JavaScript ×©× ×›×ª×‘ ×¢×‘×•×¨ ××¡×š ×“×™×•×•×— ×”×ª×§×œ×” ×‘××¢×¨×›×ª ××•×¡×š ×”××•×¤× ×™×™×.</p>
        </div>
        
        <h2>ğŸš² ×“×™×•×•×— ×ª×§×œ×” ×‘××•×¤× ×™×™×</h2>
        <p style="color: #666; margin-bottom: 20px;">×‘×—×¨ ××ª ×”××•×¤× ×™×™× ×•×ª×ª ×”×§×˜×’×•×¨×™×•×ª ×”×¨×œ×•×•× ×˜×™×•×ª ×œ×ª×§×œ×”</p>
        
        <!-- ××§×•×¨×“×™×•×Ÿ ×“×™× ××™ -->
        <div id="categoriesAccordion">
            <!-- JavaScript ×™×™×¦×•×¨ ××ª ×”×ª×•×›×Ÿ ×›××Ÿ -->
        </div>
        
        <!-- ×’×™×‘×•×™ - ×”×˜×•×¤×¡ ×”××§×•×¨×™ (××•×¡×ª×¨) -->
        <div id="fallbackCategories">
            <h4>ğŸ“‹ ×‘×—×¨ ×ª×§×œ×•×ª ××”×¨×©×™××”:</h4>
            <!-- ×¡×™××•×œ×¦×™×” ×©×œ checkboxes ×-Django -->
            <label><input type="checkbox" name="subcategories" value="1"> ×‘×œ××™× > ×‘×œ××™× ×œ× ×¢×•×¦×¨×™×</label><br>
            <label><input type="checkbox" name="subcategories" value="2"> ×‘×œ××™× > ×—×¨×™×§×•×ª ×‘×œ××™×</label><br>
            <label><input type="checkbox" name="subcategories" value="3"> ×‘×œ××™× > ×™×“×™×•×ª ×‘×œ××™× ×¨×¤×•×™×•×ª</label><br>
            <label><input type="checkbox" name="subcategories" value="4"> ×’×œ×’×œ×™× > ×¤× ×¦'×¨</label><br>
            <label><input type="checkbox" name="subcategories" value="5"> ×’×œ×’×œ×™× > ×’×œ×’×œ ×¢×§×•×</label><br>
            <label><input type="checkbox" name="subcategories" value="6"> ×’×œ×’×œ×™× > ×—×™×©×•×§×™× ×©×‘×•×¨×™×</label><br>
            <label><input type="checkbox" name="subcategories" value="7"> ×©×¨×©×¨×ª > ×©×¨×©×¨×ª ×§×•×¤×¦×ª</label><br>
            <label><input type="checkbox" name="subcategories" value="8"> ×©×¨×©×¨×ª > ×©×¨×©×¨×ª ×—×•×¨×§×ª</label><br>
            <label><input type="checkbox" name="subcategories" value="9"> ×©×¨×©×¨×ª > ×©×¨×©×¨×ª ×©×‘×•×¨×”</label><br>
        </div>
        
        <div style="margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px;">
            <h4>ğŸ” ×‘×“×™×§×•×ª ×œ×‘×™×¦×•×¢:</h4>
            <ul>
                <li>âœ… ×”×× ××•×¦×’ ××§×•×¨×“×™×•×Ÿ ×‘××§×•× ×¨×©×™××ª ×¦'×§×‘×•×§×¡×™×?</li>
                <li>âœ… ×”×× ×œ×—×™×¦×” ×¢×œ ×›×•×ª×¨×ª ×§×˜×’×•×¨×™×” ×¤×•×ª×—×ª/×¡×•×’×¨×ª?</li>
                <li>âœ… ×”×× ×‘×—×™×¨×ª ×¦'×§×‘×•×§×¡ ××¡× ×›×¨× ×ª ×¢× ×”×˜×•×¤×¡ ×”××•×¡×ª×¨?</li>
                <li>âœ… ×”×× ×–×” × ×¨××” ×˜×•×‘ ×‘××•×‘×™×™×œ?</li>
            </ul>
        </div>
        
        <div id="selectedValues" style="margin-top: 20px; padding: 15px; background-color: #e9ecef; border-radius: 8px; display: none;">
            <h4>ğŸ¯ ×¢×¨×›×™× × ×‘×—×¨×™×:</h4>
            <div id="selectedList"></div>
        </div>
    </div>

    <script>
    // ××•×ª×• ×§×•×“ JavaScript ××”×ª×‘× ×™×ª ×”××§×•×¨×™×ª
    document.addEventListener('DOMContentLoaded', function() {
        const accordionContainer = document.getElementById('categoriesAccordion');
        const fallbackContainer = document.getElementById('fallbackCategories');
        
        if (!accordionContainer || !fallbackContainer) {
            console.error('Required containers not found');
            return;
        }
        
        // ×—×™×¤×•×© ×›×œ ×”-checkboxes ×©×œ subcategories
        const checkboxes = fallbackContainer.querySelectorAll('input[type="checkbox"][name="subcategories"]');
        console.log(`Found ${checkboxes.length} subcategory checkboxes`);
        
        if (checkboxes.length === 0) {
            console.log('No subcategories found - showing message');
            accordionContainer.innerHTML = `
                <div style="padding: 20px; background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; text-align: center;">
                    <h4 style="color: #856404; margin-bottom: 10px;">âš ï¸ ××™×Ÿ ×§×˜×’×•×¨×™×•×ª ×–××™× ×•×ª</h4>
                    <p style="color: #856404; margin-bottom: 15px;">
                        ×›×¨×’×¢ ××™×Ÿ ×§×˜×’×•×¨×™×•×ª ×ª×§×œ×” ×‘××¢×¨×›×ª.<br>
                        ×ª×•×›×œ ×œ×ª××¨ ××ª ×”×ª×§×œ×” ×‘×ª×™×‘×ª ×”×˜×§×¡×˜ ×œ××˜×”.
                    </p>
                    <small style="color: #6c757d;">
                        ğŸ’¡ ×× ×”×œ ×”××¢×¨×›×ª ×™×›×•×œ ×œ×”×•×¡×™×£ ×§×˜×’×•×¨×™×•×ª ×“×¨×š ×¤×× ×œ ×”× ×™×”×•×œ
                    </small>
                </div>
            `;
            fallbackContainer.style.display = 'block';
            return;
        }
        
        // ×™×© checkboxes - ×‘×•××• × ×‘× ×” ××§×•×¨×“×™×•×Ÿ
        console.log('Building accordion...');
        const categories = {};
        
        // ××™×¨×’×•×Ÿ ×”checkboxes ×œ×¤×™ ×§×˜×’×•×¨×™×•×ª
        checkboxes.forEach(checkbox => {
            const label = checkbox.nextElementSibling || checkbox.parentElement.querySelector('label');
            if (!label) return;
            
            let labelText = label.textContent || label.innerText;
            labelText = labelText.trim();
            
            console.log(`Processing checkbox: ${labelText}`);
            
            // ×—×™×¤×•×© ×¤×•×¨××˜ "×§×˜×’×•×¨×™×” > ×ª×ª ×§×˜×’×•×¨×™×”"
            if (labelText.includes(' > ')) {
                const parts = labelText.split(' > ');
                const categoryName = parts[0].trim();
                const subcategoryName = parts[1].trim();
                
                if (!categories[categoryName]) {
                    categories[categoryName] = [];
                }
                
                categories[categoryName].push({
                    checkbox: checkbox,
                    name: subcategoryName,
                    value: checkbox.value
                });
            } else {
                // ×× ××™×Ÿ ×¤×•×¨××˜ ×‘×¨×•×¨, ×©×™× ×‘"×›×œ×œ×™"
                if (!categories['×›×œ×œ×™']) {
                    categories['×›×œ×œ×™'] = [];
                }
                
                categories['×›×œ×œ×™'].push({
                    checkbox: checkbox,
                    name: labelText,
                    value: checkbox.value
                });
            }
        });
        
        console.log('Categories:', Object.keys(categories));
        
        // ×‘× ×™×™×ª ×”××§×•×¨×“×™×•×Ÿ
        let accordionHTML = '';
        
        Object.keys(categories).forEach(categoryName => {
            const categoryId = `cat_${categoryName.replace(/\s+/g, '_')}`;
            
            accordionHTML += `
                <div class="category-section">
                    <button type="button" class="category-header" onclick="toggleAccordion('${categoryId}')">
                        <span>${categoryName}</span>
                        <span class="arrow" id="arrow_${categoryId}">â–¼</span>
                    </button>
                    <div class="category-content" id="${categoryId}" style="display: none;">
            `;
            
            categories[categoryName].forEach(subcategory => {
                const checked = subcategory.checkbox.checked ? 'checked' : '';
                accordionHTML += `
                    <div class="subcategory-item">
                        <label>
                            <input type="checkbox" name="subcategories" value="${subcategory.value}" ${checked} 
                                   onchange="syncCheckbox('${subcategory.value}', this.checked)">
                            <span class="subcategory-label">${subcategory.name}</span>
                        </label>
                    </div>
                `;
            });
            
            accordionHTML += '</div></div>';
        });
        
        accordionContainer.innerHTML = accordionHTML;
        fallbackContainer.style.display = 'none';
        
        console.log(`Accordion created with ${Object.keys(categories).length} categories`);
        
        // ×”×¦×’×ª ×¢×¨×›×™× × ×‘×—×¨×™× (×œ×‘×“×™×§×”)
        updateSelectedValues();
    });

    // ×¤×•× ×§×¦×™×” ×œ×¤×ª×™×—×”/×¡×’×™×¨×” ×©×œ ××§×•×¨×“×™×•×Ÿ
    function toggleAccordion(categoryId) {
        const content = document.getElementById(categoryId);
        const arrow = document.getElementById(`arrow_${categoryId}`);
        
        if (content.style.display === 'none') {
            // ×¡×’×™×¨×ª ×›×œ ×”××—×¨×™×
            document.querySelectorAll('.category-content').forEach(c => c.style.display = 'none');
            document.querySelectorAll('.arrow').forEach(a => a.textContent = 'â–¼');
            
            // ×¤×ª×™×—×ª ×”× ×•×›×—×™
            content.style.display = 'block';
            arrow.textContent = 'â–²';
        } else {
            content.style.display = 'none';
            arrow.textContent = 'â–¼';
        }
    }

    // ×¤×•× ×§×¦×™×” ×œ×¡× ×›×¨×•×Ÿ ×¢× ×”×˜×•×¤×¡ ×”××§×•×¨×™
    function syncCheckbox(value, checked) {
        const originalCheckbox = document.querySelector(`#fallbackCategories input[value="${value}"]`);
        if (originalCheckbox) {
            originalCheckbox.checked = checked;
        }
        updateSelectedValues();
    }
    
    // ×¤×•× ×§×¦×™×” ×œ×”×¦×’×ª ×¢×¨×›×™× × ×‘×—×¨×™× (×œ×‘×“×™×§×”)
    function updateSelectedValues() {
        const selectedContainer = document.getElementById('selectedValues');
        const selectedList = document.getElementById('selectedList');
        const fallbackContainer = document.getElementById('fallbackCategories');
        
        const checkedBoxes = fallbackContainer.querySelectorAll('input[type="checkbox"]:checked');
        
        if (checkedBoxes.length > 0) {
            selectedContainer.style.display = 'block';
            let listHTML = '';
            checkedBoxes.forEach(cb => {
                const label = cb.parentElement;
                listHTML += `<div>âœ… ${label.textContent.trim()}</div>`;
            });
            selectedList.innerHTML = listHTML;
        } else {
            selectedContainer.style.display = 'none';
        }
    }
    </script>
</body>
</html>
