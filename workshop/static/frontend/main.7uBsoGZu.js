import{r as o}from"./client.CZIp3qzo.js";function w(i,a="customer"){const[S,s]=o.useState(!1),[d,f]=o.useState([]),e=o.useRef(null),r=o.useRef(null),c=()=>{if(e.current?.readyState===WebSocket.OPEN)return;const b=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/workshop/${a}/`;e.current=new WebSocket(b),e.current.onopen=()=>{console.log("ðŸ”Œ WebSocket connected"),s(!0),g()},e.current.onmessage=t=>{try{const n=JSON.parse(t.data);console.log("ðŸ“¨ WebSocket message:",n),f(k=>[...k,n])}catch(n){console.error("Error parsing WebSocket message:",n)}},e.current.onclose=t=>{console.log("âŒ WebSocket disconnected:",t.code),s(!1),l(),setTimeout(()=>{console.log("ðŸ”„ Attempting to reconnect..."),c()},3e3)},e.current.onerror=t=>{console.error("WebSocket error:",t),s(!1)}},g=()=>{r.current=setInterval(()=>{e.current?.readyState===WebSocket.OPEN&&e.current.send(JSON.stringify({type:"ping",timestamp:Date.now()}))},3e4)},l=()=>{r.current&&(clearInterval(r.current),r.current=null)},p=u=>{e.current?.readyState===WebSocket.OPEN?e.current.send(JSON.stringify(u)):console.warn("WebSocket not connected, cannot send message")};return o.useEffect(()=>(c(),()=>{l(),e.current&&e.current.close()}),[i,a]),{isConnected:S,messages:d,sendMessage:p,connect:c}}export{w as u};
//# sourceMappingURL=main.7uBsoGZu.js.map
