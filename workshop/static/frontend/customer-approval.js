(function(){function N({repairData:a,csrfToken:u,submitUrl:g}){if(!window.React){console.error('React is not loaded');return null;}const{useState:c,useEffect:p,createElement:e}=React;const[l,d]=c(new Set),[i,h]=c(!1),[r,f]=c(!1),[x,b]=c(null);p(()=>{const s=new Set;a.repair_items?.forEach(t=>{t.is_approved_by_customer&&s.add(t.id)}),d(s)},[a]);const v=s=>{const t=new Set(l);t.has(s)?t.delete(s):t.add(s),d(t)},w=async s=>{if(s.preventDefault(),!(l.size===0||!i)){f(!0),b(null);try{const t=new FormData;if(t.append("csrfmiddlewaretoken",u),l.forEach(C=>{t.append("approved_items",C)}),(await fetch(g,{method:"POST",body:t})).ok)y("×”×¤×¢×•×œ×•×ª ××•×©×¨×• ×‘×”×¦×œ×—×”!"),setTimeout(()=>{window.location.href="/"},2e3);else throw new Error("Failed to submit approval")}catch{b("×©×’×™××” ×‘×©×œ×™×—×ª ×”××™×©×•×¨. × ×¡×” ×©×•×‘.")}finally{f(!1)}}},y=s=>{const t=document.createElement("div");t.className="success-message",t.innerHTML=`<i class="fas fa-check-circle" style="margin-left: 0.5rem;"></i>${s}`,document.body.appendChild(t),setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t)},3e3)},k=()=>{let s=0,t=0;return a.repair_items?.forEach(m=>{l.has(m.id)&&(s+=parseFloat(m.price||0),t++)}),{count:t,total:s}},_=s=>new Date(s).toLocaleDateString("he-IL",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}),{count:o,total:n}=k(),S=o>0&&i&&!r;return e("div",{className:"approval-container"},e("div",{className:"text-center mb-8"},e("div",{className:"mobile-hidden"},e("h1",{className:"text-4xl font-bold text-white mb-2"},"ğŸ“‹ ××™×©×•×¨ ×ª×™×§×•×Ÿ #",a.repair_id)),e("div",{className:"md:hidden"},e("h1",{className:"text-2xl font-bold text-white mb-2"},"××™×©×•×¨ ×ª×™×§×•×Ÿ #",a.repair_id)),e("p",{className:"text-slate-400 text-lg"},"×‘×—×¨ ××ª ×”×¤×¢×•×œ×•×ª ×©×‘×¨×¦×•× ×š ×œ××©×¨")),x&&e("div",{className:"card bg-danger mb-6 p-4"},e("div",{className:"flex items-center gap-3"},e("i",{className:"fas fa-exclamation-triangle color-danger text-xl"}),e("p",{className:"color-danger font-medium"},x))),e("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6"},e("div",{className:"lg:col-span-1"},e("div",{className:"card p-6 space-y-6"},e("div",{className:"border-b border-slate-700 pb-4"},e("h3",{className:"text-xl font-bold text-white flex items-center gap-2 mb-4"},e("i",{className:"fas fa-bicycle color-info"}),"×¤×¨×˜×™ ×”×ª×™×§×•×Ÿ")),e("div",{className:"bg-primary p-4 rounded-lg"},e("div",{className:"flex items-center gap-3"},e("div",{className:"w-12 h-12 bg-blue-500/30 rounded-lg flex items-center justify-center"},e("i",{className:"fas fa-bicycle text-blue-400 text-xl"})),e("div",null,e("div",{className:"text-white font-bold text-lg"},a.bike_info.brand+" "+a.bike_info.model),e("div",{className:"color-primary text-sm"},"×œ×§×•×—: "+a.bike_info.customer_name)))),e("div",{className:"space-y-3"},e("div",{className:"flex justify-between items-center py-2 border-b border-slate-700/50"},e("span",{className:"text-slate-400"},"×ª××¨×™×š ×“×™×•×•×—:"),e("span",{className:"text-white font-medium"},_(a.created_at))),e("div",{className:"flex justify-between items-center py-2"},e("span",{className:"text-slate-400"},"×¡×˜×˜×•×¡:"),e("span",{className:"status-badge bg-success color-success"},e("i",{className:"fas fa-check-circle"}),a.status_display))),a.problem_description&&e("div",null,e("h4",{className:"text-white font-bold mb-2 flex items-center gap-2"},e("i",{className:"fas fa-exclamation-circle color-danger"}),"×”×ª×§×œ×” ×©×“×™×•×•×—×ª:"),e("div",{className:"bg-danger p-3 rounded-lg"},e("p",{className:"text-red-100 text-sm leading-relaxed"},a.problem_description))),a.diagnosis&&e("div",null,e("h4",{className:"text-white font-bold mb-2 flex items-center gap-2"},e("i",{className:"fas fa-stethoscope color-success"}),"××‘×—×•×Ÿ ×”××•×¡×š:"),e("div",{className:"bg-success p-3 rounded-lg"},e("p",{className:"text-green-100 text-sm leading-relaxed"},a.diagnosis))))),e("div",{className:"lg:col-span-2 space-y-6"},a.repair_items&&a.repair_items.length>0?e("div",{className:"card p-6"},e("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2"},e("i",{className:"fas fa-tools color-warning"}),"×¤×¢×•×œ×•×ª ×ª×™×§×•×Ÿ ××•×¦×¢×•×ª"),e("div",{className:"space-y-4"},...a.repair_items.map(s=>e("div",{key:s.id,className:`repair-item ${l.has(s.id)?"selected":""}`,onClick:()=>v(s.id)},e("div",{className:"flex items-start gap-4"},e("div",{className:"flex-shrink-0 mt-1"},e("input",{type:"checkbox",className:"custom-checkbox",checked:l.has(s.id),onChange:()=>{}})),e("div",{className:"flex-1 min-w-0"},e("div",{className:"mobile-grid-fix flex justify-between items-start gap-4"},e("div",{className:"flex-1"},e("h4",{className:"text-white font-bold text-lg mb-2 flex items-center gap-2"},e("i",{className:"fas fa-wrench color-info"}),s.description),s.notes&&e("p",{className:"text-slate-400 text-sm bg-slate-700/50 p-2 rounded"},e("i",{className:"fas fa-sticky-note color-warning ml-1"}),s.notes)),e("div",{className:"flex-shrink-0 mobile-text-center mobile-full-width"},e("div",{className:"price-tag"},"â‚ª"+parseFloat(s.price).toFixed(0)))))))))):e("div",{className:"card p-8 text-center"},e("div",{className:"w-16 h-16 bg-warning mx-auto mb-4 rounded-full flex items-center justify-center"},e("i",{className:"fas fa-clock color-warning text-2xl"})),e("h3",{className:"text-white font-bold text-xl mb-2"},"×”××ª×Ÿ ×œ××‘×—×•×Ÿ ×”××•×¡×š"),e("p",{className:"text-slate-400"},"×”××•×¡×š ×¢×“×™×™×Ÿ ×œ× ×”×•×¡×™×£ ×¤×¢×•×œ×•×ª ×œ×ª×™×§×•×Ÿ ×–×”")),a.repair_items&&a.repair_items.length>0&&[e("div",{key:"summary",className:"card p-6"},e("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2"},e("i",{className:"fas fa-calculator color-info"}),"×¡×™×›×•× ×”×–×× ×”"),e("div",{className:"mobile-grid-fix grid grid-cols-2 gap-4"},e("div",{className:"bg-primary p-4 rounded-lg text-center"},e("div",{className:"text-3xl font-bold color-primary mb-1"},o),e("div",{className:"text-blue-200 text-sm"},"×¤×¢×•×œ×•×ª × ×‘×—×¨×•")),e("div",{className:"bg-success p-4 rounded-lg text-center"},e("div",{className:"text-3xl font-bold color-success mb-1"},"â‚ª"+n.toFixed(0)),e("div",{className:"text-green-200 text-sm"},"×¡×”×´×› ××—×™×¨")))),e("div",{key:"confirmation",className:"card p-6"},e("div",{className:"flex items-start gap-4 cursor-pointer p-4 rounded-lg bg-warning transition-all hover:bg-yellow-500/20",onClick:()=>h(!i)},e("div",{className:"flex-shrink-0 mt-1"},e("input",{type:"checkbox",className:"custom-checkbox",checked:i,onChange:()=>{}})),e("div",null,e("h4",{className:"text-white font-bold text-lg mb-3 flex items-center gap-2"},e("i",{className:"fas fa-signature color-warning"}),"××™×©×•×¨ ×‘×™×¦×•×¢ ×”×¤×¢×•×œ×•×ª"),e("div",{className:"text-yellow-100 text-sm space-y-1 leading-relaxed"},e("div",null,"âœ“ ×× ×™ ×××©×¨/×ª ××ª ×‘×™×¦×•×¢ ×”×¤×¢×•×œ×•×ª ×©× ×‘×—×¨×•"),e("div",null,"âœ“ ×× ×™ ××¡×›×™×/×” ×œ×ª×©×œ×•× ×‘×¡×›×•× ×©×œ â‚ª"+n.toFixed(0)),e("div",null,"âœ“ ×× ×™ ××‘×™×Ÿ/×” ×©×œ× × ×™×ª×Ÿ ×œ×‘×˜×œ ×œ××—×¨ ×”××™×©×•×¨"))))),e("div",{key:"buttons",className:"mobile-stack flex gap-4"},e("button",{type:"button",onClick:w,disabled:!S,className:"btn btn-success mobile-full-width flex-1"},r?[e("div",{key:"spinner",className:"loading-spinner"}),"×©×•×œ×— ××™×©×•×¨..."]:[e("i",{key:"icon",className:"fas fa-check-double"}),`××©×¨ ${o} ×¤×¢×•×œ×•×ª (â‚ª${n.toFixed(0)})`]),e("a",{href:"/",className:"btn btn-secondary mobile-full-width"},e("i",{className:"fas fa-home"}),"×—×–×¨×” ×œ×“×£ ×”×‘×™×ª"))])),e("div",{className:"card bg-info p-4 mt-8"},e("div",{className:"flex items-start gap-3"},e("i",{className:"fas fa-info-circle color-info text-xl mt-1"}),e("div",{className:"text-blue-100 text-sm"},e("p",{className:"font-medium mb-1"},"××™×š ×–×” ×¢×•×‘×“?"),e("p",null,'×‘×—×¨ ××ª ×”×¤×¢×•×œ×•×ª ×©×‘×¨×¦×•× ×š ×©×”××•×¡×š ×™×‘×¦×¢ ×•×œ×—×¥ ×¢×œ "××©×¨". ×œ××—×¨ ×”××™×©×•×¨, ×”×¤×¢×•×œ×•×ª ×™×•×¢×‘×¨×• ×œ×‘×™×¦×•×¢ ×•×”××•×¡×š ×™×ª×—×™×œ ×œ×¢×‘×•×“ ×¢×œ ×”××•×¤× ×™×™× ×©×œ×š.')))))}window.CustomerApproval=N})();
